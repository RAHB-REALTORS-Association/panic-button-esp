<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Favicon Setup -->
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
  <link rel="icon" type="image/x-icon" href="favicon/favicon.ico">
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon-180x180.png">
  
  <!-- Android Chrome Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="favicon/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="favicon/android-chrome-512x512.png">
  
  <!-- Web Manifest -->
  <link rel="manifest" href="favicon/site.webmanifest">

  <!-- Stylesheet -->
  <link rel="stylesheet" href="styles.css">

  <title>ESP32 Panic Button Documentation</title>
</head>
<body>
  <nav>
    <div class="container nav-container">
      <div class="logo">
        <a href="#"><img src="images/logo/logo-medium.png" alt="Panic Button Logo" class="main-logo"></a>
      </div>
      <div class="nav-icons">
        <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp" target="_blank" class="icon-btn" title="View on GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
          </svg>
        </a>
        <button id="dark-mode-toggle" class="icon-btn" title="Toggle Dark Mode">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        <div class="hamburger-menu">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
      <div class="nav-links">
        <a href="#features">Features</a>
        <a href="#hardware">Hardware</a>
        <a href="#libraries">Dependencies</a>
        <a href="#getting-started">Getting Started</a>
        <a href="#simulator">Simulator</a>
        <a href="#battery">Battery</a>
        <a href="#webhook">Webhook</a>
        <a href="#usage">Usage</a>
        <a href="#case">Case</a>
        <a href="#ota-updates">OTA Updates</a>
      </div>
      <div class="menu-overlay"></div>
    </div>
  </nav>

  <header>
    <div class="container header-content">
      <h1>
        ESP32 Wi-Fi Panic Button
      </h1>
      <p>A standalone emergency alert system with email, webhook notifications and battery monitoring</p>
    </div>
  </header>

  <main class="container">
    <section id="features">
      <h2>‚ú® Features</h2>
      <div class="feature-grid">
        <div class="feature-card">
          <h3>Wi-Fi Configuration</h3>
          <p>Easy setup with a user-friendly captive portal for network configuration</p>
        </div>
        <div class="feature-card">
          <h3>Email Alerts</h3>
          <p>Sends instant SMTP email notifications when the panic button is activated</p>
        </div>
        <div class="feature-card">
          <h3>Webhook Integration</h3>
          <p>Send JSON payloads to custom endpoints for integration with other systems</p>
        </div>
        <div class="feature-card">
          <h3>Battery Monitoring</h3>
          <p>Visual battery gauge with percentage display and low battery alerts</p>
        </div>
        <div class="feature-card">
          <h3>OTA Updates</h3>
          <p>Automatic Over-The-Air firmware updates for easy maintenance</p>
        </div>
        <div class="feature-card">
          <h3>Testing & Reset</h3>
          <p>Built-in functions for testing notifications and performing factory resets</p>
        </div>
      </div>
    </section>

    <section id="hardware">
      <h2>üõ†Ô∏è Hardware Requirements</h2>
      <ul>
        <li><strong>Microcontroller:</strong> <a href="https://www.dfrobot.com/product-2771.html" target="_blank">DFRobot FireBeetle 2 ESP32-C6</a></li>
        <li><strong>Input:</strong> Momentary push-button switch (connected to GPIO 4)</li>
        <li><strong>Indicator:</strong> Status LED (GPIO 15, onboard LED)</li>
        <li><strong>Battery:</strong> LiPo battery connected to onboard JST connector</li>
        <li><strong>Battery Monitoring:</strong> Via ADC (GPIO 0)</li>
      </ul>
      
      <h3 style="margin-top: 1.5rem; color: var(--dark);">Pinout Configuration</h3>
      <table>
        <thead>
          <tr>
            <th>Component</th>
            <th>GPIO Pin</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Panic Button</td>
            <td>4</td>
            <td>Active LOW (connect to GND when pressed)</td>
          </tr>
          <tr>
            <td>Status LED</td>
            <td>15</td>
            <td>Onboard LED, indicates system status</td>
          </tr>
          <tr>
            <td>Battery ADC</td>
            <td>0</td>
            <td>Monitors battery voltage level</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="libraries">
      <h2>üì¶ Dependencies</h2>
      <p>This project relies on the following <a href="https://www.arduino.cc" target="_blank">Arduino</a> libraries:</p>
      <ul>
        <li><a href="https://github.com/mobizt/ESP-Mail-Client" target="_blank">ESP Mail Client</a> - For sending email alerts</li>
        <li><strong>HTTPClient</strong> - For webhook functionality</li>
        <li><strong>WiFi</strong> - For network connectivity</li>
        <li><strong>WebServer</strong> - For hosting the control panel interface</li>
        <li><strong>DNSServer</strong> - For the captive portal functionality</li>
        <li><strong>EEPROM</strong> - For persistent storage of settings</li>
      </ul>
      
      <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp" class="btn" target="_blank">View Project on GitHub</a>
    </section>

    <section id="getting-started">
      <h2>üöÄ Getting Started</h2>
      <ol>
        <li><strong>Flash the Firmware:</strong> Upload the project code to your ESP32-C6 using the <a href="https://www.arduino.cc/en/software/" target="_blank">Arduino IDE</a>.</li>
        <li><strong>Initial Setup:</strong> When first powered on, the ESP32 will enter Setup Mode:
          <ul>
            <li>The device creates a Wi-Fi access point named <code>PanicAlarm_XXXX</code> (where XXXX is derived from the MAC address)</li>
            <li>Connect to this network with password <code>setupalarm</code></li>
            <li>A captive portal should automatically open (or navigate to <code>192.168.4.1</code>)</li>
            <li>Configure Wi-Fi, email and/or webhook notifications, and device location</li>
          </ul>
        </li>
        <li><strong>Normal Operation:</strong> After configuration, the device will:
          <ul>
            <li>Connect to your Wi-Fi network</li>
            <li>Begin monitoring for button presses</li>
            <li>Track battery status</li>
            <li>Show operational status via the LED indicator</li>
          </ul>
        </li>
        <li><strong>Accessing the Interface:</strong> Find the device's IP address from your router or serial monitor, then access it via a web browser.</li>
      </ol>
    </section>

    <section id="simulator">
      <h2>üîß Web Interface Simulator</h2>
      <p>Try out the control panel interface with this interactive simulator:</p>
      <div class="simulator-frame">
        <iframe src="simulator.html"></iframe>
      </div>
    </section>

    <section id="battery">
      <h2>üîã Battery Monitoring</h2>
      <p>The device includes comprehensive battery monitoring with visual feedback:</p>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Battery Gauge</h3>
      <p>The control panel displays a color-coded battery level indicator:</p>
      
      <div class="battery-gauge">
        <div class="battery-level" style="width: 75%;">
          <span class="battery-text">75%</span>
        </div>
      </div>
      
      <ul>
        <li><strong>Green:</strong> Good battery level (above 50%)</li>
        <li><strong>Yellow/Orange:</strong> Medium battery level (25-50%)</li>
        <li><strong>Red:</strong> Low battery (below 25%)</li>
      </ul>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Low Battery Alerts</h3>
      <p>When battery level drops below 50%, the device will:</p>
      <ul>
        <li>Send a low battery warning email (if email notifications are enabled)</li>
        <li>Send a low battery webhook notification (if webhook is enabled)</li>
        <li>Blink the LED in a specific pattern to indicate low battery</li>
      </ul>
      
      <p>Both voltage and percentage information are tracked and included in notifications.</p>
    </section>

    <section id="webhook">
      <h2>üåê Webhook Integration</h2>
      <p>The device can send JSON payloads to a custom URL when events occur:</p>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Webhook Payload Example</h3>
      <pre><code>{
  "event": "PANIC_ALARM_TRIGGERED",
  "device_id": "PanicAlarm_AB12",
  "mac_address": "A4:CF:12:67:AB:12",
  "location": "Front Door",
  "ip_address": "192.168.1.42",
  "battery_voltage": 3.82,
  "battery_percentage": 68,
  "triggered_at": 1428
}</code></pre>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Event Types</h3>
      <ul>
        <li><code>PANIC_ALARM_TRIGGERED</code> - When the panic button is pressed</li>
        <li><code>LOW_BATTERY_WARNING</code> - When battery level drops below 25%</li>
      </ul>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Testing</h3>
      <p>You can test webhook functionality directly from the web interface using the "Test Webhook" button in the control panel.</p>
    </section>

    <section id="usage">
      <h2>üì± Usage Instructions</h2>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Triggering an Alert</h3>
      <ul>
        <li><strong>Hardware Method:</strong> Press the physical button connected to GPIO 4</li>
        <li><strong>Software Methods:</strong>
          <ul>
            <li>Visit <code>http://[device-ip]/test</code> to test email notification</li>
            <li>Visit <code>http://[device-ip]/test-webhook</code> to test webhook notification</li>
          </ul>
        </li>
      </ul>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">Factory Reset</h3>
      <p>To clear all stored settings and return to setup mode:</p>
      <ol>
        <li>Navigate to <code>http://[device-ip]/reset</code> in your browser</li>
        <li>Confirm the reset when prompted</li>
        <li>The device will restart and create the setup access point</li>
      </ol>
      
      <h3 style="margin-top: 1rem; color: var(--dark);">LED Status Indicators</h3>
      <table>
        <thead>
          <tr>
            <th>Pattern</th>
            <th>Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Solid On</td>
            <td>Alert triggered / sending notifications</td>
          </tr>
          <tr>
            <td>Slow Blink (5 pulses)</td>
            <td>Setup mode active</td>
          </tr>
          <tr>
            <td>Quick Blink (5 pulses)</td>
            <td>Low battery warning</td>
          </tr>
          <tr>
            <td>3 Blinks</td>
            <td>Successfully connected to WiFi</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="case">
      <div class="section-with-image">
        <div class="content">
          <h2>üñ®Ô∏è 3D-Printed Case</h2>
          <p>This project includes a printable enclosure designed for the FireBeetle ESP32-C6 and a small push-button. You can find the model files in the <code>case/v1/</code> directory of the <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp" target="_blank">GitHub repository</a>:</p>
          <ul>
            <li><code>panic_button_case.3mf</code> ‚Äì full project file with all parts arranged</li>
            <li><code>case_back.stl</code> (<a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/case/v1/case_back.stl" target="_blank">View</a>)</li>
            <li><code>case_bottom.stl</code> (<a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/case/v1/case_bottom.stl" target="_blank">View</a>)</li>
            <li><code>case_front.stl</code> (<a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/case/v1/case_front.stl" target="_blank">View</a>)</li>
            <li><code>case_top.stl</code> (<a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/case/v1/case_top.stl" target="_blank">View</a>)</li>
          </ul>
    
          <h3>Recommended Print Settings</h3>
          <ul>
            <li><strong>Material:</strong> PLA, PETG, or similar</li>
            <li><strong>Layer height:</strong> 0.2 mm</li>
            <li><strong>Infill:</strong> 15‚Äì20%</li>
            <li><strong>Supports:</strong> Optional (recommended if top and bottom alignment is critical)</li>
            <li><strong>Walls:</strong> 2‚Äì3 perimeters</li>
          </ul>
    
          <p>Align the case halves carefully post-print; the included case_top and case_bottom have interlocking features with screw holes that benefit from clean bridging or light support settings.</p>
        </div>
        <div class="image-container">
          <img src="images/screenshot/panic-button.jpg" alt="Panic Button Case" class="right-aligned-image">
        </div>
      </div>
    </section>

    <section id="ota-updates">
      <h2>üîÑ OTA Updates</h2>
      <p>This device supports automatic Over-The-Air firmware updates via the included OTA update server:</p>
      
      <ul>
        <li><strong>Automatic Updates:</strong> Devices check for updates periodically</li>
        <li><strong>Secure Authentication:</strong> Server verifies device identity and firmware compatibility</li>
        <li><strong>Zero-Touch Deployment:</strong> Updates are downloaded and applied automatically</li>
        <li><strong>Configuration Preservation:</strong> OTA updates preserve all user configurations and settings</li>
      </ul>
      
      <p>For hosting your own OTA update server, refer to the <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/tree/master/ota-server" target="_blank">OTA Server README</a> for complete setup and usage instructions.</p>
    </section>

    <section id="license">
      <h2>üìÑ License</h2>
      <p><strong>Firmware:</strong> The source code for this project is licensed under the GNU General Public License v3.0 (GPLv3). You are free to use, modify, and distribute it under the terms of this license. See the full <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/LICENSE">LICENSE</a> for more information.</p>
      <p><strong>OTA Server:</strong> The OTA server code is licensed under the GNU Affero General Public License v3.0 (AGPLv3). You are free to use, modify, and distribute it under the terms of this license. See the full <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/ota-server/LICENSE">ota-server/LICENSE</a> for more information.</p>
      <p><strong>3D-Printed Case:</strong> The STL and 3MF files for the enclosure are licensed under the MIT License, allowing for open use and modification with attribution. See <a href="https://github.com/RAHB-REALTORS-Association/panic-button-esp/blob/master/case/LICENSE">case/LICENSE</a> for details.</p>
    </section>
  </main>

  <footer class="container">
    <p>Made with <span class="heart">AI ü§ñ</span> at <a href="https://www.cornerstone.inc">Cornerstone Association of REALTORS¬Æ</a></p>
  </footer>

  <!-- JavaScript -->
  <script src="scripts.js"></script>
</body>
</html>